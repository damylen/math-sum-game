<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zappy Math</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Fredoka One', cursive;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background-color: #6dd5ed;
            color: #333;
        }
        
        .header {
            text-align: center;
            padding: 20px;
            background-color: #2193b0;
        }
        
        #logo {
            width: 120px;
            height: 120px;
            margin-bottom: 10px;
        }
        
        h1 {
            font-size: 2.5rem;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .game-container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            padding: 20px;
        }
        
        .settings,
        .answer-section {
            width: 100%;
            max-width: 400px;
            margin-bottom: 20px;
        }
        
        .slider-container {
            margin-bottom: 15px;
        }
        
        .slider {
            width: 100%;
            margin-top: 5px;
            -webkit-appearance: none;
            appearance: none;
            height: 15px;
            background: #d3d3d3;
            outline: none;
            opacity: 0.7;
            transition: opacity .2s;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 25px;
            height: 25px;
            background: #ffd700;
            cursor: pointer;
            border-radius: 50%;
        }
        
        .slider::-moz-range-thumb {
            width: 25px;
            height: 25px;
            background: #ffd700;
            cursor: pointer;
            border-radius: 50%;
        }
        
        #number-display {
            font-size: 8rem;
            font-weight: bold;
            height: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #333;
            text-align: center;
            padding: 20px;
        }
        
        button,
        input[type="number"],
        select {
            background-color: #ffd700;
            border: none;
            border-radius: 25px;
            color: #333;
            cursor: pointer;
            font-size: 1.2rem;
            margin: 10px;
            padding: 15px 30px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        input[type="number"] {
            width: 150px;
            text-align: center;
        }
        
        button:hover,
        select:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
        
        button:active,
        select:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .hidden {
            display: none;
        }
        
        #rounds-value {
            font-size: 2rem;
            display: block;
            text-align: center;
            margin-top: 10px;
        }
        
        #difficulty-text {
            text-align: center;
            margin-top: 15px;
            margin-bottom: 15px;
        }
        
        #language-select {
            position: absolute;
            top: 10px;
            right: 10px;
        }
    </style>
</head>

<body>
    <select id="language-select">
        <option value="en">English</option>
        <option value="nl">Nederlands</option>
    </select>
    <div class="header">
        <svg id="logo" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg">
            <circle cx="60" cy="60" r="55" fill="#FFD700" stroke="#2193b0" stroke-width="4"/>
            <text x="60" y="50" font-family="Arial" font-size="24" text-anchor="middle" fill="#2193b0" font-weight="bold">Zappy</text>
            <text x="60" y="80" font-family="Arial" font-size="24" text-anchor="middle" fill="#2193b0" font-weight="bold">Math</text>
            <path d="M30 90 Q60 110 90 90" stroke="#2193b0" stroke-width="4" stroke-linecap="round" fill="none"/>
        </svg>
        <h1>Zappy Math</h1>
    </div>
    <div class="game-container">
        <div id="settings" class="settings">
            <div class="slider-container">
                <label for="speed"><span class="i18n" data-i18n="speed">Speed (seconds):</span> <span id="speed-value">1.0</span></label>
                <input type="range" id="speed" class="slider" min="0.2" max="2" step="0.2" value="1">
            </div>
            <div class="slider-container">
                <label for="rounds"><span class="i18n" data-i18n="rounds">Number of Rounds:</span></label>
                <input type="range" id="rounds" class="slider" min="3" max="20" step="1" value="5">
                <span id="rounds-value">5</span>
            </div>
            <div id="difficulty-text"></div>
            <button id="start-game" class="i18n" data-i18n="start">Start Zapping!</button>
        </div>
        <div id="number-display"></div>
        <div id="answer-section" class="answer-section hidden">
            <input type="number" id="user-answer" placeholder="Enter your guess">
            <button id="submit-answer" class="i18n" data-i18n="submit">Submit Answer</button>
            <button id="skip-answer" class="i18n" data-i18n="skip">Skip (Reveal Sum)</button>
        </div>
        <button id="new-game" class="hidden i18n" data-i18n="newGame">Zap Again!</button>
        <button id="share-button" class="hidden i18n" data-i18n="share">Share Zappy Math!</button>
    </div>

    <script>
        let sum = 0;
        let currentRound = 0;
        let intervalId;
        let currentLanguage = 'en';

        const translations = {
            en: {
                speed: "Speed (seconds):",
                rounds: "Number of Rounds:",
                start: "Start Zapping!",
                submit: "Submit Answer",
                skip: "Skip (Reveal Sum)",
                newGame: "Zap Again!",
                share: "Share Zappy Math!",
                correct: "Correct! The sum is",
                incorrect: "The correct sum is",
                zappyEnd: "Zappy End!",
                zappySum: "The Zappy Sum is:",
                enterGuess: "Enter your guess",
                shareText: "I just scored {score} in Zappy Math! Can you beat my score?",
                difficulty: "Difficulty:"
            },
            nl: {
                speed: "Snelheid (seconden):",
                rounds: "Aantal Rondes:",
                start: "Begin met Zappen!",
                submit: "Antwoord Indienen",
                skip: "Overslaan (Toon Som)",
                newGame: "Zap Opnieuw!",
                share: "Deel Zappy Math!",
                correct: "Correct! De som is",
                incorrect: "De juiste som is",
                zappyEnd: "Zappy Einde!",
                zappySum: "De Zappy Som is:",
                enterGuess: "Voer je gok in",
                shareText: "Ik heb net {score} gescoord in Zappy Math! Kun jij mijn score verslaan?",
                difficulty: "Moeilijkheidsgraad:"
            }
        };

        const difficultyNames = {
            en: [
                "Zappy Novice", "Number Nibbler", "Math Munchkin", "Calculation Cadet",
                "Arithmetic Apprentice", "Sum Sorcerer", "Equation Expert", "Numeric Ninja",
                "Mathematic Mastermind", "Zappy Zen Master"
            ],
            nl: [
                "Zappy Beginner", "Getallen Knabbelaar", "Wiskunde Munchkin", "Berekenings Cadet",
                "Rekenkundige Leerling", "Som Tovenaar", "Vergelijkings Expert", "Numerieke Ninja",
                "Wiskundige Meesterbrein", "Zappy Zen Meester"
            ]
        };

        const startGameBtn = document.getElementById('start-game');
        const submitAnswerBtn = document.getElementById('submit-answer');
        const skipAnswerBtn = document.getElementById('skip-answer');
        const newGameBtn = document.getElementById('new-game');
        const shareBtn = document.getElementById('share-button');
        const numberDisplay = document.getElementById('number-display');
        const settingsDiv = document.getElementById('settings');
        const answerSection = document.getElementById('answer-section');
        const userAnswerInput = document.getElementById('user-answer');
        const speedSlider = document.getElementById('speed');
        const roundsSlider = document.getElementById('rounds');
        const speedValue = document.getElementById('speed-value');
        const roundsValue = document.getElementById('rounds-value');
        const difficultyText = document.getElementById('difficulty-text');
        const languageSelect = document.getElementById('language-select');

        function updateDifficulty() {
            const speed = parseFloat(speedSlider.value);
            const rounds = parseInt(roundsSlider.value);
            const difficultyScore = Math.min(Math.floor(((2 - speed) / 0.18 + (rounds - 3) / 1.7) / 2), 9);
            difficultyText.textContent = `${translations[currentLanguage].difficulty} ${difficultyNames[currentLanguage][difficultyScore]}`;
        }

        function updateLanguage() {
            document.querySelectorAll('.i18n').forEach(element => {
                const key = element.dataset.i18n;
                if (translations[currentLanguage][key]) {
                    if (element.tagName === 'INPUT' && element.type === 'text') {
                        element.placeholder = translations[currentLanguage][key];
                    } else {
                        element.textContent = translations[currentLanguage][key];
                    }
                }
            });
            userAnswerInput.placeholder = translations[currentLanguage].enterGuess;
            updateDifficulty();
        }

        function setCookie(name, value, days) {
            const expires = new Date(Date.now() + days * 24 * 60 * 60 * 1000).toUTCString();
            document.cookie = `${name}=${value}; expires=${expires}; path=/`;
        }

        function getCookie(name) {
            const cookieArr = document.cookie.split(';');
            for (let i = 0; i < cookieArr.length; i++) {
                let cookiePair = cookieArr[i].split('=');
                if (name == cookiePair[0].trim()) {
                    return decodeURIComponent(cookiePair[1]);
                }
            }
            return null;
        }

        function loadSettings() {
            const savedLanguage = getCookie('language');
            if (savedLanguage) {
                currentLanguage = savedLanguage;
                languageSelect.value = savedLanguage;
            }
            const savedSpeed = getCookie('speed');
            if (savedSpeed) {
                speedSlider.value = savedSpeed;
                speedValue.textContent = savedSpeed;
            }
            const savedRounds = getCookie('rounds');
            if (savedRounds) {
                roundsSlider.value = savedRounds;
                roundsValue.textContent = savedRounds;
            }
            updateLanguage();
            updateDifficulty();
        }

        speedSlider.addEventListener('input', () => {
            speedValue.textContent = parseFloat(speedSlider.value).toFixed(1);
            updateDifficulty();
            setCookie('speed', speedSlider.value, 30);
        });

        roundsSlider.addEventListener('input', () => {
            roundsValue.textContent = Math.round(roundsSlider.value);
            updateDifficulty();
            setCookie('rounds', roundsSlider.value, 30);
        });

        languageSelect.addEventListener('change', (e) => {
            currentLanguage = e.target.value;
            updateLanguage();
            setCookie('language', currentLanguage, 30);
        });

        startGameBtn.addEventListener('click', startGame);
        submitAnswerBtn.addEventListener('click', checkAnswer);
        skipAnswerBtn.addEventListener('click', showSum);
        newGameBtn.addEventListener('click', resetGame);
        shareBtn.addEventListener('click', shareGame);

        function startGame() {
            const speed = parseFloat(speedSlider.value) * 1000;
            const rounds = Math.round(roundsSlider.value);

            sum = 0;
            currentRound = 0;
            settingsDiv.classList.add('hidden');
            answerSection.classList.add('hidden');
            newGameBtn.classList.add('hidden');
            shareBtn.classList.add('hidden');

            intervalId = setInterval(() => {
                if (currentRound < rounds) {
                    const randomNumber = Math.floor(Math.random() * 21) - 10;
                    sum += randomNumber;
                    numberDisplay.textContent = randomNumber;
                    currentRound++;
                } else {
                    clearInterval(intervalId);
                    numberDisplay.textContent = translations[currentLanguage].zappyEnd;
                    answerSection.classList.remove('hidden');
                }
            }, speed);
        }

        function checkAnswer() {
            const userAnswer = parseInt(userAnswerInput.value);
            if (userAnswer === sum) {
                numberDisplay.textContent = `${translations[currentLanguage].correct} ${sum}`;
            } else {
                numberDisplay.textContent = `${translations[currentLanguage].incorrect} ${sum}`;
            }
            finishGame();
        }

        function showSum() {
            numberDisplay.textContent = `${translations[currentLanguage].zappySum} ${sum}`;
            finishGame();
        }

        function finishGame() {
            answerSection.classList.add('hidden');
            newGameBtn.classList.remove('hidden');
            shareBtn.classList.remove('hidden');
        }

        function resetGame() {
            numberDisplay.textContent = '';
            newGameBtn.classList.add('hidden');
            shareBtn.classList.add('hidden');
            settingsDiv.classList.remove('hidden');
            userAnswerInput.value = '';
        }

        function shareGame() {
            if (navigator.share) {
                navigator.share({
                    title: 'Zappy Math',
                    text: translations[currentLanguage].shareText.replace('{score}', sum),
                    url: 'https://damylen.github.io/math-sum-game/'
                }).then(() => {
                    console.log('Thanks for sharing!');
                }).catch(console.error);
            } else {
                alert('Sharing is not supported on this device.');
            }
        }

        loadSettings(); // Initialize settings and language
    </script>
</body>

</html>